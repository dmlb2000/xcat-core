=head1 NAME

B<nimnodeset> - Use this xCAT command to initialize AIX/NIM standalone machines.

=head1 SYNOPSIS

B<nimnodeset [-h|--help ]>

B<nimnodeset [-V|--verbose] [-f|--force] [-i osimage_name] [-p|--primarySN] [-b|--backupSN] noderange [attr=val [attr=val ...]]>

=head1 DESCRIPTION

This xCAT command can be used to initialize AIX/NIM standalone machines. Once this step is completed the xCAT rnetboot command may be used to initiate a network boot of the nodes.

If you are using xCAT service nodes the B<nimnodeset> command will automatically determine the correct server(s) for the node and do the initialization on that server(s).

The osimage_name is the name of an xCAT osimage definition that contains the list of NIM resources to use when initializing the nodes.   If the osimage_name is not provided on the command line the code checks the node definition for the value of the "profile" attribute (which is the name of an osimage definition). If the osimage_image is provided on the command line then the code will also set the "profile" attribute of the node definiions.

You can specify additional attributes and values using the "attr=val" command line option.  This information will be passed on to the underlying call to the NIM "nim -o bos_inst" command.  See the NIM documentation for information on valid command line options for the nim command.  The "attr" must correspond to a NIM attribute supported for the NIM "bos_inst" operation.  Information provided by the "attr=val" option will take precedence over the information provided in the osimage definition.

The force option can be used to reinitialize a node if it already has resources allocated or it is in the wrong NIM state. This option will reset the NIM node and deallocate resources before reinititializing.

This command will also create a NIM script resource to enable the xCAT support for user-provided customization scripts.

After the nimnodeset command completes you can use the lsnim command to check the NIM node definition to see if it is ready for booting the node. ("lsnim -l <nim_node_name>").

You can supply your own scripts to be run on the mn or on the service node (if their is hierarchy) for a node during the nimnodeset command. Such scripts are called B<prescripts>. They should be copied to /install/prescripts dirctory. A table called I<prescripts> is used to specify the scripts and their associated actions. The scripts to be run at the beginning of the nimnodeset command are stored in the 'begin' column of I<prescripts> table. The scripts to be run at the end of the nimnodeset command are stored in the 'end' column of I<prescripts> table. Please run 'tabdump prescripts -d' command for details. An example for the 'begin' or the 'end' column is: I<standalone:myscript1,myscript2>. The following two environment variables will be passed to each script: NODES contains all the names of the nodes that need to run the script for and ACTION contains the current current nodeset action, in this case "standalone". If I<#xCAT setting:MAX_INSTANCE=number> is specified in the script, the script will get invoked for each node in parallel, but no more than I<number> of instances will be invoked at at a time. If it is not sepcified, the script will be invoked once for all the nodes.

=head1 OPTIONS

=over 10

=item B<attr=val [attr=val ...]>

Specifies one or more "attribute equals value" pairs, separated by spaces. Attr=
val pairs must be specified last on the command line. These are used to specify additional values that can be passed to the underlying NIM commands, ("nim -o bos_inst ...").  See the NIM documentation for valid "nim" command line options. Note that you may specify multiple "script" and "installp_bundle" values by using a comma seperated list. (ex. "script=ascript,bscript").

=item B<-b|--backupSN>

When using backup service nodes only update the backup.  The default is to update both the primary and backup service nodes

=item B<-f |--force>

Use the force option to reinitialize the NIM machines.

=item B<-h |--help>

Display usage message.

=item B<-i image_name>

The name of an existing xCAT osimage definition.

=item B<-p|--primarySN>

When using backup service nodes only update the primary.  The default is to update both the primary and backup service nodes.

=item B<noderange>

A set of comma delimited node names and/or group names. See the "noderange" man page for details on additional supported formats.

=item B<-V |--verbose>

Verbose mode.

=back

=head1 RETURN VALUE

=over 3

=item 0

The command completed successfully.

=item 1

An error has occurred.

=back

=head1 EXAMPLES

1) Initialize an xCAT node named "node01".  Use the xCAT osimage named "61gold" to install the node.

=over 5

B<nimnodeset -i 61gold node01>

=back

2) Initialize all AIX nodes contained in the xCAT node group called "aixnodes" using the image definitions pointed to by the "profile" attribute of the xCAT node definitions.

=over 5

B<nimnodeset aixnodes>

=back


3) Initialize an xCAT node called "node02".  Include installp_bundle resources that are not included in the osimage definition. This assumes the NIM installp_bundle resources have already been created.

=over 5

B<nimnodeset -i 611image node02 installp_bundle=sshbundle,addswbundle>

=back

=head1 FILES

/opt/xcat/bin/nimnodeset

=head1 NOTES

This command is part of the xCAT software product.

=head1 SEE ALSO

L<mknimimage(1)|mknimimage.1>, L<rnetboot(1)|rnetboot.1>


