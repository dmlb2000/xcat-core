=head1 NAME

B<lsslp> - Discovers selected networked services information within the same subnet.

=head1 SYNOPSIS

I<lsslp [-h| --help]>

I<lsslp [-v| --version]>


I<lsslp [<noderange>] [-V| --verbose] [-i ip[,ip..]][-w][-r|-x|-z][-n][-s BPA|MM|IVM|RSA|FSP|HMC][-t tries][-m][-I][-e command][-c [timeinterval[timeinterval,..]]][-C counts][-T timeout][--vpdtable][-M vpd|switchport][--updatehosts][-makedhcp][--resetnet]>


=head1 DESCRIPTION

The lsslp command discovers selected service types using the -s flag. All service types are returned if the -s flag is not specified. If a specific IP address is not specified using the -i flag, the request is sent out all available network adapters. The optional -r, -x, -z and --vpdtable flags format the output.

NOTE: SLP broadcast requests will propagate only within the subnet of the network adapter broadcast IPs specified by the -i flag.

=head1 OPTIONS

B<noderange>   The nodes which the user want to discover.
            If the user specify the noderange, lsslp will just return the nodes in 
			the node range. Which means it will help to add the new nodes to the xCAT
			database without modifying the existed definitions. But the nodes' name 
			specified in noderange should be defined in database in advance. The specified
			nodes' type can be frame/cec/hmc/fsp/bpa. If the it is frame or cec, lsslp
			will list the bpa or fsp nodes within the nodes(bap for frame, fsp for cec).
			Please do not use noderange with the flag -s.

B<-c>          Convergence timeout.
            A value-list of 32 bit integers used as timeouts, in milliseconds, to
            implement the convergence algorithm. Each value specifies the time
            to wait before sending the next request, or until nothing new
            has been learned from two successive requests. A maximum of 5 comma-
            seperated values are allowed. Note that specifying -c with no arguments
            will use the timeout values last specified. Not including -c will use
            the hardcoded defaults of 500,750,1000,1500,2000 milliseconds.

B<-i>          IP(s) the command will send out (defaults to all available adapters).

B<-e>          Path and command name of IBM SLP slp_query (defaults to OpenSLP - slptool).
            An IBM proprietary implementation of SLP can be also be used.
            Contact IBM for details. 

B<-h>          Display usage message.

B<-m>          Multicast mode (defaults to broadcast).

B<--makedhcp>  Issue xCAT command makedhcp internally.

B<-M>          Matching mode, match the pre-defined node names from vpd table or switch table.
            Default is using factory name if no -M specified.

B<-n>          Only display and write the newly discovered hardwares.

B<-r>          Display Raw SLP response.

B<-C>          The number of the nodes expected to find, specified by the user. 
            When using this flag, lsslp will not return until the it has found all the nodes or time out.
            The default max time is 5 minutes. The user can use -T flag the specify the time they want to use.
            A short time will limite the time costing, while a long time will help to find all the nodes.
            
B<-T>          The number in seconds to limite the time costing of lsslp. Must be used with the flag -C.
            See the help of flag -C for more details.            

B<--resetnet>  Login to hardwares and reset the network interfaces. This option is only valid
            for the nodes with different attributes: ip and otherinterfaces in hosts table.

B<-s>          Service type interested in discovering.

B<-t>          Number or service-request attempts.

B<--updatehosts>  Display current IP address or write the ip address into xCAT DB. Please be 
            aware that otherinterfaces column in hosts table saved the current ip address, 
            ip column stores the new ip address that user defined. With this option, lsslp
            will write the current ip to ip column also, which means the ip user wants is 
            the same as current ip address running on hardwares. This is to avoid useless 
            network resetting that if ip and otherinterfaces are the same, lsslp will skip
            the network resetting for that node.

B<--vpdtable>  Output the SLP response in vpdtable formatting. Easy for writting data to vpd table.

B<-v>          Command Version.

B<-V>          Verbose output.

B<-w>          Writes output to xCAT database.

B<-x>          XML format.

B<-z>          Stanza formated output.

B<-I>          Give the warning message for the nodes in database which have no SLP responses.
            Please note that this flag noly can be used after the database migration finished successfully.


=head1 RETURN VALUE

0 The command completed successfully.

1 An error has occurred.

=head1 EXAMPLES

1. To list all discovered HMC service types in tabular format with convergence timeouts of 5000,5000,2000,1000,1000 milliseconds, enter:

 lsslp -s HMC -c 5000,5000,2000,1000,1000

Output is similar to:

 device type-model serial-number ip-addresses                    hostname
 HMC    7310CR2    103F55A        1.1.1.115 2.2.2.164 3.3.3.102  hmc01
 HMC    7310CR2    105369A        3.3.3.103 2.2.2.103 1.1.1.163  hmc02
 HMC    7310CR3    KPHHK24        3.3.3.154 2.2.2.110 1.1.1.154  hmc03


2. list all discovered FSP service types in raw response format on subnet 30.0.0.255, enter:

 lsslp -i 3.0.0.255 -s FSP -r

Output is similar to:

 (type=cec-service-processor),(serial-number=10A3AEB),(machinetype-model=9117-570),(fru-serial-number=YL11C5338102),(hostname=),(frame-number=0),(cage-number=0),(ip-address=3.0.0.94,1.1.1.147),(web-url=https://3.0.0.94:473 ), (slot=1),(bpc-machinetype-model=0),(bpc-serial-number=0),(Image=fips240/b0630a_0623.240)
 (type=cec-service-processor),(serial-number=10A3E2B),(machinetype-model=9117-570),(fru-serial- number=YL11C5338250),(hostname=),(frame-number=0),(cage-number=0),(ip-address=3.0.0.95,1.1.1.147), (web-url=https://3.0.0.95:473 ),(slot=1),(bpc-machinetype-model=0),(bpc-serial-number=0),(Image=fips240/b0630a_0623.240)



3. To list all discovered MM service types in XML format and write the output to the xCAT database, enter:

 lsslp -s MM -x -w

Output is similar to:

  <Node>
    <groups>mm,all</groups>
    <id>00:14:5E:E0:CB:1E</id>
    <mgt>blade</mgt>
    <mtm>029310C</mtm>
    <node>Server-029310C-SN100485A-A</node>
    <nodetype>mm</nodetype>
    <otherinterfaces>9.114.47.229</otherinterfaces>
    <serial>100485A</serial>
  </Node>


4. To list all discovered service types in stanza format and write the output to the xCAT database, enter:

 lsslp -z -w

Output is similar to:

c76v1hmc02:
        objtype=node
        hcp=c76v1hmc02
        nodetype=hmc
        mtm=7315CR2
        serial=10407DA
        ip=192.168.200.125 20.0.0.125 9.114.113.125
        groups=hmc,all
        mgt=hmc
        mac=00:1a:64:fb:7d:50		
        hidden=0
192.168.200.244:
        objtype=node
        hcp=192.168.200.244
        nodetype=fsp
        mtm=9125-F2A
        serial=0262662
        side=A-0
        ip=192.168.200.244
        groups=fsp,all
        mgt=fsp
        id=4
        parent=Server-9125-F2A-SN0262662
        mac=00:1a:64:fa:01:fe
        hidden=1
Server-8205-E6B-SN1074CDP:
        objtype=node
        hcp=Server-8205-E6B-SN1074CDP
        nodetype=cec
        mtm=8205-E6B
        serial=1074CDP
        groups=cec,all
        mgt=fsp
        id=0
        hidden=0
192.168.200.33:
        objtype=node
        hcp=192.168.200.33
        nodetype=bpa
        mtm=9458-100
        serial=99201WM
        side=B-0
        ip=192.168.200.33
        groups=bpa,all
        mgt=bpa
        id=0
        mac=00:09:6b:ad:19:90
        hidden=1
Server-9125-F2A-SN0262652:
        objtype=node
        hcp=Server-9125-F2A-SN0262652
        nodetype=frame
        mtm=9125-F2A
        serial=0262652
        groups=frame,all
        mgt=fsp
        id=5
        hidden=0



5. To list all discovered service types in stanza format and display the IP address, enter:

 lsslp -w --updatehosts

Output is similar to:

 mm01:
    objtype=node
    nodetype=fsp
    mtm=8233-E8B
    serial=1000ECP
    side=A-0
    groups=fsp,all
    mgt=fsp
    id=0
    mac=00:14:5E:F0:5C:FD
    ip=50.0.0.5

 bpa01:
    objtype=node
    nodetype=bpa
    mtm=9A01-100
    serial=0P1N746
    side=A-1
    groups=bpa,all
    mgt=bpa
    id=0
    mac=00:1A:64:54:8C:A5
    ip=50.0.0.1


6. To list all the FSPs and reset their network interfaces to get new IP from dhcp server, enter:

 lsslp -s FSP --resetnet

Output is similar to:

 Start to reset network..

 Reset network failed nodes:

 Reset network succeed nodes:
 Server-8233-E8B-SN1000ECP-A,Server-9119-FHA-SN0275995-B,Server-9119-FHA-SN0275995-A,

 Reset network finished.
 
device  type-model  serial-number  side  ip-addresses  hostname
FSP     9117-MMB    105EBEP        A-1   20.0.0.138    20.0.0.138
FSP     9117-MMB    105EBEP        B-1   20.0.0.139    20.0.0.139
FSP     8205-E6B    1040C7P        A-1   20.0.0.141    20.0.0.141
FSP     8233-E8B    100538P        A-0   20.0.0.146    20.0.0.146
FSP     9125-F2A    0262652        A-1   20.0.0.166    20.0.0.166
FSP     9125-F2A    027ACA4        A-1   20.0.0.169    20.0.0.169

 
7. To list all the nodes defined in database which have no SLP response.

  lsslp -I 

Output is similar to:

   Warning: The node Server-8204-E8 has no response.
  
   Warning: The node Server-8203-E4 has no response.
  
  device  type-model  serial-number  side  ip-addresses       hostname
  BPA     9458-100    99201WM        B-1   10.1.255.250       10.1.255.250
  FSP     9125-F2A    0262652        A-0   192.168.200.16     192.168.200.16
  FSP     8233-E8B    1000ECP        A-0   192.168.200.19     192.168.200.19
  CEC     8205-E6B    1040C7P                                 Server-8205-E6B-SN1040C7P

8. To find the nodes within the user specified. Please make sure the noderange input have been defined in xCAT database.

   lsslp CEC1-CEC3
or lsslp CEC1,CEC2,CEC3

  device  type-model  serial-number  side  ip-addresses     hostname
  FSP     9A01-100    0P1P336        A-0   192.168.200.34  192.168.200.34
  FSP     9A01-100    0P1P336        B-0   192.168.200.35  192.168.200.35
  FSP     9A01-100    0P1P336        A-1   50.0.0.27       50.0.0.27
  FSP     9A01-100    0P1P336        B-1   50.0.0.28       50.0.0.28
  CEC     9A01-100    0P1P336                              CEC1
  FSP     8233-E8B    1040C7P        A-0   192.168.200.36  192.168.200.36
  FSP     8233-E8B    1040C7P        B-0   192.168.200.37  192.168.200.37
  FSP     8233-E8B    1040C7P        A-1   50.0.0.29       50.0.0.29
  FSP     8233-E8B    1040C7P        B-1   50.0.0.30       50.0.0.30
  CEC     8233-E8B    1040C7P                              CEC2
  FSP     8205-E6B    1000ECP        A-0   192.168.200.38  192.168.200.38
  FSP     8205-E6B    1000ECP        B-0   192.168.200.39  192.168.200.39
  FSP     8205-E6B    1000ECP        A-1   50.0.0.31       50.0.0.27
  FSP     8205-E6B    1000ECP        B-1   50.0.0.32       50.0.0.28
  CEC     8205-E6B    1000ECP                              CEC3  


=head1 FILES

/opt/xcat/bin/lsslp


=head1 SEE ALSO

L<rscan(1)|rscan.1>




