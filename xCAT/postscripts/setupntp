#!/bin/sh
# IBM(c) 2007 EPL license http://www.eclipse.org/legal/epl-v10.html
#
#---------------------------------------------------------------------------
# setup NTP configuration on the compute nodes
#
#---------------------------------------------------------------------------
master=$MASTER
conf_file="/etc/ntp.conf"
conf_file_backup="/etc/ntp.conf.postbackup"
# if backup does not exist, backup
if [ !  -f $conf_file_backup ]; then
   mv -f $conf_file $conf_file_backup
fi

logger -t xcat "Install: Setup NTP"

echo "server $master" >$conf_file

mkdir -p /etc/ntp
chown ntp /etc/ntp

echo "driftfile /etc/ntp/drift
multicastclient
broadcastdelay	0.008
authenticate no
keys		/etc/ntp/keys
trustedkey	65535
requestkey	65535
controlkey	65535" >>$conf_file


